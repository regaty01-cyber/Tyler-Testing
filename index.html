<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Garage Golf Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 100%);
            color: white;
            overflow-x: hidden;
            height: auto;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            padding: 10px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .mode-selector {
            display: flex;
            gap: 8px;
            margin: 15px 0;
        }

        .mode-btn {
            flex: 1;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 12px 8px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mode-btn.active {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }

        .mode-section {
            display: none;
        }

        .mode-section.active {
            display: block;
        }

        .camera-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
        }

        .video-container {
            position: relative;
            width: 100%;
            height: 250px;
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #videoStream {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 15px;
        }

        .camera-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-size: 48px;
            opacity: 0.5;
        }

        .camera-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .camera-btn {
            flex: 1;
            background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .camera-btn.active {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }

        .camera-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }

        .club-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(70px, 1fr));
            gap: 8px;
            margin: 15px 0;
        }

        .club-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 12px 6px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .club-btn.selected {
            background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
        }

        .distance-target {
            background: linear-gradient(45deg, #2d5a27, #4a7c59);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            text-align: center;
        }

        .target-distance {
            font-size: 32px;
            font-weight: bold;
            color: #90EE90;
            margin-bottom: 10px;
        }

        .club-stats {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .course-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }

        .course-card {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .course-card.selected {
            background: linear-gradient(45deg, #2196F3, #21CBF3);
        }

        .course-name {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .course-info {
            font-size: 12px;
            opacity: 0.8;
        }

        .setup-instructions {
            background: rgba(255, 193, 7, 0.2);
            border: 2px solid #FFC107;
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
        }

        .setup-instructions h3 {
            color: #FFC107;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .setup-instructions ul {
            list-style: none;
            padding: 0;
        }

        .setup-instructions li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }

        .setup-instructions li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #4CAF50;
            font-weight: bold;
        }

        .shot-history {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
        }

        .shot-entry {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
        }

        .shot-entry:last-child {
            border-bottom: none;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 15px 0;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ff4444;
            animation: pulse 2s infinite;
        }

        .status-dot.active {
            background: #44ff44;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Mobile optimization */
        @media (max-width: 480px) {
            .mode-selector {
                flex-direction: column;
                gap: 10px;
            }
            
            .course-selector {
                grid-template-columns: 1fr;
            }
            
            .camera-controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèåÔ∏è Garage Golf Simulator</h1>
            <p>Real Ball Flight Tracking</p>
            
            <div class="mode-selector">
                <button class="mode-btn active" id="practiceMode" onclick="switchMode('practice')">
                    üìπ Practice
                </button>
                <button class="mode-btn" id="drivingRangeMode" onclick="switchMode('range')">
                    üéØ Range
                </button>
                <button class="mode-btn" id="coursePlayMode" onclick="switchMode('course')">
                    ‚õ≥ Course
                </button>
            </div>
        </div>

        <!-- Practice Mode -->
        <div id="practiceModeSection" class="mode-section active">
            <div class="setup-instructions">
                <h3>üìã Setup Instructions</h3>
                <ul>
                    <li>Place iPhone 6-10 feet from hitting area</li>
                    <li>Ensure good lighting in your garage</li>
                    <li>Use white golf balls for better tracking</li>
                    <li>Clear background behind ball flight path</li>
                    <li>Calibrate distance for accurate measurements</li>
                </ul>
            </div>

            <div class="camera-section">
                <div class="video-container">
                    <video id="videoStream" autoplay playsinline muted></video>
                    <canvas id="canvas"></canvas>
                    <div class="camera-placeholder" id="cameraPlaceholder">
                        üìπ
                        <p style="font-size: 16px; margin-top: 10px;">Camera will appear here</p>
                    </div>
                </div>
                
                <div class="camera-controls">
                    <button class="camera-btn" id="startCamera" onclick="startCamera()">
                        Start Camera
                    </button>
                    <button class="camera-btn" id="trackingBtn" onclick="toggleTracking()" disabled>
                        Start Tracking
                    </button>
                    <button class="camera-btn" onclick="captureShot()" disabled id="captureBtn">
                        Capture Shot
                    </button>
                </div>
            </div>

            <div class="status-indicator">
                <div class="status-dot" id="statusDot"></div>
                <span id="statusText">Ready to start camera</span>
            </div>

            <div class="shot-history">
                <h3>üìà Recent Shots</h3>
                <div id="shotHistoryList">
                    <div style="text-align: center; opacity: 0.6; padding: 20px;">
                        No shots recorded yet
                    </div>
                </div>
            </div>
        </div>

        <!-- Driving Range Mode -->
        <div id="drivingRangeModeSection" class="mode-section">
            <h3>üéØ Driving Range Practice</h3>
            <p>Perfect your distances with each club</p>
            
            <div class="club-selector">
                <button class="club-btn selected" onclick="selectClub('Driver')">Driver</button>
                <button class="club-btn" onclick="selectClub('3W')">3-Wood</button>
                <button class="club-btn" onclick="selectClub('5W')">5-Wood</button>
                <button class="club-btn" onclick="selectClub('5I')">5-Iron</button>
                <button class="club-btn" onclick="selectClub('6I')">6-Iron</button>
                <button class="club-btn" onclick="selectClub('7I')">7-Iron</button>
                <button class="club-btn" onclick="selectClub('8I')">8-Iron</button>
                <button class="club-btn" onclick="selectClub('9I')">9-Iron</button>
                <button class="club-btn" onclick="selectClub('PW')">PW</button>
                <button class="club-btn" onclick="selectClub('SW')">SW</button>
            </div>

            <div class="distance-target">
                <div class="target-distance" id="targetDistance">250 yds</div>
                <div>Target Distance - <span id="selectedClub">Driver</span></div>
                <div id="accuracyFeedback">Hit a shot to see accuracy</div>
            </div>

            <div class="club-stats">
                <h4>üìä <span id="clubStatsTitle">Driver</span> Statistics</h4>
                <div class="stat-row">
                    <span>Average Distance:</span>
                    <span id="avgDistance">0 yds</span>
                </div>
                <div class="stat-row">
                    <span>Best Shot:</span>
                    <span id="bestShot">0 yds</span>
                </div>
                <div class="stat-row">
                    <span>Shots Hit:</span>
                    <span id="shotsHit">0</span>
                </div>
                <div class="stat-row">
                    <span>Accuracy:</span>
                    <span id="clubAccuracy">0%</span>
                </div>
            </div>

            <button class="camera-btn" onclick="takeRangeShot()" style="width: 100%; margin-top: 20px;">
                üì∏ Take Practice Shot
            </button>
        </div>

        <!-- Course Play Mode -->
        <div id="coursePlayModeSection" class="mode-section">
            <h3>‚õ≥ Play Golf Courses</h3>
            
            <div class="course-selector">
                <div class="course-card selected" onclick="selectCourse('pebble')">
                    <div class="course-name">Pebble Beach</div>
                    <div class="course-info">Par 72 ‚Ä¢ 6,828 yds</div>
                </div>
                <div class="course-card" onclick="selectCourse('augusta')">
                    <div class="course-name">Augusta National</div>
                    <div class="course-info">Par 72 ‚Ä¢ 7,475 yds</div>
                </div>
                <div class="course-card" onclick="selectCourse('stAndrews')">
                    <div class="course-name">St. Andrews</div>
                    <div class="course-info">Par 72 ‚Ä¢ 7,279 yds</div>
                </div>
                <div class="course-card" onclick="selectCourse('torrey')">
                    <div class="course-name">Torrey Pines</div>
                    <div class="course-info">Par 72 ‚Ä¢ 7,698 yds</div>
                </div>
            </div>

            <div id="courseHoleDisplay" style="display: none;">
                <div class="distance-target">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <div>
                            <div style="font-size: 20px; font-weight: bold;">Hole <span id="courseHoleNumber">1</span></div>
                            <div id="courseHoleName" style="font-size: 14px; opacity: 0.8;">Ocean Views</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 24px; color: #90EE90; font-weight: bold;">
                                <span id="courseHoleDistance">380</span> yds
                            </div>
                            <div>Par <span id="courseHolePar">4</span></div>
                        </div>
                    </div>
                    
                    <button class="camera-btn" onclick="takeCourseShot()" style="width: 100%; margin-top: 15px;">
                        üèåÔ∏è Take Shot
                    </button>
                    
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button class="club-btn" onclick="nextCourseHole()" style="flex: 1;">Next Hole</button>
                        <button class="club-btn" onclick="viewScorecard()" style="flex: 1;">Scorecard</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shot Analysis (appears after any shot) -->
        <div id="shotAnalysis" style="display: none; background: linear-gradient(45deg, #2196F3, #21CBF3); border-radius: 20px; padding: 20px; margin: 20px 0;">
            <h3>üèåÔ∏è Shot Analysis</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 12px; opacity: 0.8;">Ball Speed</div>
                    <div style="font-size: 20px; font-weight: bold; color: #90EE90;" id="ballSpeedResult">140 mph</div>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 12px; opacity: 0.8;">Distance</div>
                    <div style="font-size: 20px; font-weight: bold; color: #90EE90;" id="distanceResult">245 yds</div>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 12px; opacity: 0.8;">Launch Angle</div>
                    <div style="font-size: 20px; font-weight: bold; color: #90EE90;" id="launchAngleResult">12¬∞</div>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 12px; opacity: 0.8;">Spin Rate</div>
                    <div style="font-size: 20px; font-weight: bold; color: #90EE90;" id="spinRateResult">2800 rpm</div>
                </div>
            </div>
            <button onclick="closeAnalysis()" style="background: rgba(255,255,255,0.3); color: white; border: none; padding: 10px 20px; border-radius: 20px; margin-top: 20px; width: 100%;">
                Close Analysis
            </button>
        </div>

        <!-- Putting Interface -->
        <div id="puttingInterface" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 1000;">
            <div style="background: linear-gradient(135deg, #2d5a27, #4a7c59); border-radius: 25px; padding: 30px; text-align: center; max-width: 90vw; border: 2px solid #90EE90;">
                <div style="font-size: 48px; margin-bottom: 15px;">‚õ≥</div>
                <div style="font-size: 24px; font-weight: bold; margin-bottom: 20px; color: #90EE90;">Ball on Green!</div>
                
                <div style="font-size: 32px; font-weight: bold; color: #FFD700; margin: 15px 0;" id="pinDistance">12 feet</div>
                <div style="opacity: 0.8; margin-bottom: 20px;">to the pin</div>
                
                <div style="background: rgba(255,255,255,0.1); border-radius: 15px; padding: 20px; margin: 20px 0;">
                    <div style="font-size: 16px; margin-bottom: 15px;">Putt Difficulty</div>
                    <div style="display: flex; justify-content: center; gap: 10px; margin-bottom: 15px;">
                        <div style="width: 20px; height: 20px; border-radius: 50%; background: rgba(255,255,255,0.3);" id="slope1"></div>
                        <div style="width: 20px; height: 20px; border-radius: 50%; background: rgba(255,255,255,0.3);" id="slope2"></div>
                        <div style="width: 20px; height: 20px; border-radius: 50%; background: rgba(255,255,255,0.3);" id="slope3"></div>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 12px; opacity: 0.8;">
                        <span>Easy</span>
                        <span>Medium</span>
                        <span>Hard</span>
                    </div>
                    <div style="margin-top: 10px; font-size: 14px;" id="slopeDescription">Moderate break, uphill putt</div>
                </div>
                
                <div style="margin-top: 25px;">
                    <div style="font-size: 16px; margin-bottom: 20px; font-weight: bold;">Select Your Result</div>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="selectPuttResult(1)" style="background: linear-gradient(45deg, #4CAF50, #45a049); color: white; border: none; padding: 15px 25px; border-radius: 20px; font-size: 16px; font-weight: bold;">
                            ‚ö° One Putt
                        </button>
                        <button onclick="selectPuttResult(2)" style="background: linear-gradient(45deg, #FF9800, #F57C00); color: white; border: none; padding: 15px 25px; border-radius: 20px; font-size: 16px; font-weight: bold;">
                            üéØ Two Putt
                        </button>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(255,193,7,0.2); border-radius: 10px; font-size: 14px;">
                    üí° Practice this putt on your putting green, then select your result
                </div>
            </div>
        </div>
    </div>

    <script>
        // App state
        let appState = {
            currentMode: 'practice',
            selectedClub: 'Driver',
            selectedCourse: 'pebble',
            currentHole: 1,
            courseStrokes: Array(18).fill(0),
            clubStats: {},
            shotHistory: [],
            camera: null,
            isTracking: false
        };

        // Club data
        const clubData = {
            'Driver': { distance: 250 },
            '3W': { distance: 230 },
            '5W': { distance: 210 },
            '5I': { distance: 170 },
            '6I': { distance: 155 },
            '7I': { distance: 140 },
            '8I': { distance: 125 },
            '9I': { distance: 110 },
            'PW': { distance: 95 },
            'SW': { distance: 80 }
        };

        // Course data
        const courses = {
            pebble: {
                name: "Pebble Beach",
                holes: [
                    {name: "Ocean Views", par: 4, distance: 380},
                    {name: "Coastal Breeze", par: 5, distance: 502},
                    {name: "Cliff Edge", par: 4, distance: 390},
                    {name: "Pine Valley", par: 3, distance: 188},
                    {name: "Ocean Drive", par: 4, distance: 166},
                    {name: "Monterey Bay", par: 5, distance: 513},
                    {name: "Seal Point", par: 3, distance: 106},
                    {name: "Carmel Gate", par: 4, distance: 418},
                    {name: "Pacific Dunes", par: 4, distance: 464}
                ]
            },
            augusta: {
                name: "Augusta National",
                holes: [
                    {name: "Tea Olive", par: 4, distance: 445},
                    {name: "Pink Dogwood", par: 5, distance: 575},
                    {name: "Flowering Peach", par: 4, distance: 350},
                    {name: "Flowering Crab Apple", par: 3, distance: 240},
                    {name: "Magnolia", par: 4, distance: 495},
                    {name: "Juniper", par: 3, distance: 180},
                    {name: "Pampas", par: 4, distance: 450},
                    {name: "Yellow Jasmine", par: 5, distance: 570},
                    {name: "Carolina Cherry", par: 4, distance: 460}
                ]
            }
        };

        // Initialize app
        function initializeApp() {
            // Initialize club stats
            Object.keys(clubData).forEach(club => {
                appState.clubStats[club] = { shots: [], best: 0 };
            });
            updateClubStats();
        }

        // Mode switching
        function switchMode(mode) {
            console.log('Switching to mode:', mode);
            appState.currentMode = mode;
            
            // Update button states
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Hide all sections
            document.querySelectorAll('.mode-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected mode
            if (mode === 'practice') {
                document.getElementById('practiceMode').classList.add('active');
                document.getElementById('practiceModeSection').classList.add('active');
            } else if (mode === 'range') {
                document.getElementById('drivingRangeMode').classList.add('active');
                document.getElementById('drivingRangeModeSection').classList.add('active');
                updateClubStats();
            } else if (mode === 'course') {
                document.getElementById('coursePlayMode').classList.add('active');
                document.getElementById('coursePlayModeSection').classList.add('active');
            }
        }

        // Club selection
        function selectClub(club) {
            console.log('Selecting club:', club);
            appState.selectedClub = club;
            
            // Update button states
            document.querySelectorAll('.club-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            // Update displays
            document.getElementById('targetDistance').textContent = clubData[club].distance + ' yds';
            document.getElementById('selectedClub').textContent = club;
            document.getElementById('clubStatsTitle').textContent = club;
            
            updateClubStats();
        }

        function updateClubStats() {
            const club = appState.selectedClub;
            const stats = appState.clubStats[club] || { shots: [], best: 0 };
            
            const avgDistance = stats.shots.length > 0 ? 
                Math.round(stats.shots.reduce((a, b) => a + b, 0) / stats.shots.length) : 0;
            
            document.getElementById('avgDistance').textContent = avgDistance + ' yds';
            document.getElementById('bestShot').textContent = stats.best + ' yds';
            document.getElementById('shotsHit').textContent = stats.shots.length;
            
            // Calculate accuracy
            const target = clubData[club].distance;
            const accurateShots = stats.shots.filter(shot => Math.abs(shot - target) <= 10).length;
            const accuracy = stats.shots.length > 0 ? Math.round((accurateShots / stats.shots.length) * 100) : 0;
            document.getElementById('clubAccuracy').textContent = accuracy + '%';
        }

        // Course functions
        function selectCourse(courseId) {
            console.log('Selecting course:', courseId);
            appState.selectedCourse = courseId;
            
            document.querySelectorAll('.course-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            document.getElementById('courseHoleDisplay').style.display = 'block';
            updateCourseHoleDisplay();
        }

        function updateCourseHoleDisplay() {
            const course = courses[appState.selectedCourse];
            const hole = course.holes[appState.currentHole - 1];
            
            document.getElementById('courseHoleNumber').textContent = appState.currentHole;
            document.getElementById('courseHoleName').textContent = hole.name;
            document.getElementById('courseHoleDistance').textContent = hole.distance;
            document.getElementById('courseHolePar').textContent = hole.par;
        }

        function nextCourseHole() {
            if (appState.currentHole < courses[appState.selectedCourse].holes.length) {
                appState.currentHole++;
                updateCourseHoleDisplay();
            } else {
                alert('Round Complete!');
                appState.currentHole = 1;
                appState.courseStrokes = Array(18).fill(0);
                updateCourseHoleDisplay();
            }
        }

        function viewScorecard() {
            const course = courses[appState.selectedCourse];
            let scoreText = `${course.name} Scorecard:\n\n`;
            
            for (let i = 0; i < Math.min(appState.currentHole, course.holes.length); i++) {
                const hole = course.holes[i];
                const strokes = appState.courseStrokes[i] || 0;
                scoreText += `Hole ${i + 1}: Par ${hole.par}, Strokes: ${strokes}\n`;
            }
            
            alert(scoreText);
        }

        // Camera functions
        async function startCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: { facingMode: 'environment' }
                });
                
                document.getElementById('videoStream').srcObject = stream;
                document.getElementById('cameraPlaceholder').style.display = 'none';
                document.getElementById('startCamera').classList.add('active');
                document.getElementById('trackingBtn').disabled = false;
                document.getElementById('captureBtn').disabled = false;
                updateStatus('Camera active', true);
                
                appState.camera = stream;
            } catch (error) {
                alert('Camera access failed. Please allow camera permissions.');
                updateStatus('Camera failed', false);
            }
        }

        function toggleTracking() {
            appState.isTracking = !appState.isTracking;
            const btn = document.getElementById('trackingBtn');
            
            if (appState.isTracking) {
                btn.textContent = 'Stop Tracking';
                btn.classList.add('active');
                updateStatus('Tracking active', true);
            } else {
                btn.textContent = 'Start Tracking';
                btn.classList.remove('active');
                updateStatus('Camera active', true);
            }
        }

        function captureShot() {
            takeShot();
        }

        function takeRangeShot() {
            takeShot();
        }

        function takeCourseShot() {
            takeShot();
        }

        function takeShot() {
            // Simulate shot data
            const club = appState.selectedClub;
            const baseDistance = clubData[club].distance;
            const actualDistance = Math.round(baseDistance + (Math.random() - 0.5) * 40);
            const ballSpeed = Math.round(actualDistance * 0.6 + Math.random() * 20);
            const launchAngle = Math.round(8 + Math.random() * 16);
            const spinRate = Math.round(2000 + Math.random() * 2000);
            
            // Update shot analysis
            document.getElementById('ballSpeedResult').textContent = ballSpeed + ' mph';
            document.getElementById('distanceResult').textContent = actualDistance + ' yds';
            document.getElementById('launchAngleResult').textContent = launchAngle + '¬∞';
            document.getElementById('spinRateResult').textContent = spinRate + ' rpm';
            
            // Show analysis
            document.getElementById('shotAnalysis').style.display = 'block';
            
            // Update mode-specific data
            if (appState.currentMode === 'range') {
                updateRangeStats(actualDistance);
            } else if (appState.currentMode === 'course') {
                updateCourseProgress(actualDistance);
            }
            
            // Add to history
            const shot = {
                time: new Date().toLocaleTimeString(),
                club: club,
                distance: actualDistance,
                speed: ballSpeed
            };
            appState.shotHistory.unshift(shot);
            appState.shotHistory = appState.shotHistory.slice(0, 5);
            updateShotHistory();
        }

        function updateRangeStats(distance) {
            const club = appState.selectedClub;
            const stats = appState.clubStats[club];
            
            stats.shots.push(distance);
            if (distance > stats.best) {
                stats.best = distance;
            }
            
            // Update accuracy feedback
            const target = clubData[club].distance;
            const diff = Math.abs(distance - target);
            let feedback = '';
            
            if (diff <= 5) feedback = 'üéØ Perfect! Right on target';
            else if (diff <= 10) feedback = '‚úÖ Great shot! Very close';
            else if (diff <= 20) feedback = 'üëç Good shot! Close to target';
            else feedback = '‚ö†Ô∏è Keep practicing - ' + (distance > target ? 'too long' : 'too short');
            
            document.getElementById('accuracyFeedback').textContent = feedback;
            updateClubStats();
        }

        function updateCourseProgress(distance) {
            const course = courses[appState.selectedCourse];
            const hole = course.holes[appState.currentHole - 1];
            
            // Add stroke
            appState.courseStrokes[appState.currentHole - 1]++;
            
            // Check if ball reached green (85%+ of hole distance)
            const progress = distance / hole.distance;
            if (progress >= 0.85) {
                setTimeout(() => {
                    showPuttingInterface(hole, distance);
                }, 2000);
            }
        }

        function showPuttingInterface(hole, approachDistance) {
            // Calculate distance to pin
            const remainingDistance = hole.distance - approachDistance;
            const pinDistance = Math.max(3, Math.min(35, remainingDistance * 0.3 + Math.random() * 15));
            
            // Random slope difficulty
            const slopeDifficulty = Math.floor(Math.random() * 3) + 1;
            
            // Update interface
            document.getElementById('pinDistance').textContent = Math.round(pinDistance) + ' feet';
            
            // Update slope indicators
            document.querySelectorAll('[id^="slope"]').forEach(dot => {
                dot.style.background = 'rgba(255,255,255,0.3)';
            });
            document.getElementById(`slope${slopeDifficulty}`).style.background = '#FF6B6B';
            
            const descriptions = {
                1: "Straight putt, minimal break",
                2: "Moderate break, manageable slope",
                3: "Severe break, tricky read required"
            };
            document.getElementById('slopeDescription').textContent = descriptions[slopeDifficulty];
            
            // Show interface
            document.getElementById('puttingInterface').style.display = 'flex';
        }

        function selectPuttResult(putts) {
            // Add putts to score
            appState.courseStrokes[appState.currentHole - 1] += putts;
            
            const totalStrokes = appState.courseStrokes[appState.currentHole - 1];
            const hole = courses[appState.selectedCourse].holes[appState.currentHole - 1];
            const scoreToPar = totalStrokes - hole.par;
            
            let scoreText = `${totalStrokes} strokes`;
            if (scoreToPar === -2) scoreText += " - Eagle! ü¶Ö";
            else if (scoreToPar === -1) scoreText += " - Birdie! üê¶";
            else if (scoreToPar === 0) scoreText += " - Par ‚úÖ";
            else if (scoreToPar === 1) scoreText += " - Bogey ‚ö†Ô∏è";
            else if (scoreToPar >= 2) scoreText += " - Double+ üò¨";
            
            alert(`Hole ${appState.currentHole} Complete!\n${putts} putt${putts > 1 ? 's' : ''}\nTotal: ${scoreText}`);
            
            // Hide interface
            document.getElementById('puttingInterface').style.display = 'none';
        }

        function closeAnalysis() {
            document.getElementById('shotAnalysis').style.display = 'none';
        }

        function updateStatus(text, active) {
            document.getElementById('statusText').textContent = text;
            document.getElementById('statusDot').classList.toggle('active', active);
        }

        function updateShotHistory() {
            const container = document.getElementById('shotHistoryList');
            if (appState.shotHistory.length === 0) {
                container.innerHTML = '<div style="text-align: center; opacity: 0.6; padding: 20px;">No shots recorded yet</div>';
            } else {
                container.innerHTML = appState.shotHistory.map(shot => 
                    `<div class="shot-entry"><span>${shot.time}</span><span>${shot.club}: ${shot.distance}yds</span></div>`
                ).join('');
            }
        }

        // Initialize when page loads
        window.addEventListener('load', initializeApp);
    </script>
</body>
</html>
